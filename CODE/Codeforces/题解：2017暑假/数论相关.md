---
title: CF数论简单题
tags:
 - codeforces
 - 数论
mathjax: true
---

数论只会GCD……

<!--more-->

##### http://codeforces.com/problemset/problem/222/C

> ​	给出两个集合，第一个集合数的乘积是分子，第二个集合的数的乘积是分母，要求够造一个同样大小的集合，但是得到的分数是化简过的。

​	考虑先用线性筛求出素数(1e7)，然后跑质因数分解，保存在数组中，取出gcd——然后对于a和b，贪心的除去gcd。

##### http://codeforces.com/problemset/problem/446/C

>​	给定n个元素的数组a[].
>
>​	操作1, l, r。要求对于l<=i<=r,a[i]] += f[i-l+1]
>
>​	询问2, l, r。范围Σa[i] (l<=i<=r)
>
>​	$n,m<=300000$
>
>​	其中$f[i]$为斐波那契数列，$f[1]=1,f[2]=1$

**斐波那契数列**

​	据说这是通项公式$\Large fib(i)=\frac{1}{\sqrt 5}((\frac{1+\sqrt 5}{2})^n+(\frac{1−\sqrt 5}{2}) ^n)$

​	然后有一个神奇的事情是，$\sqrt 5$在Mod$1e9+7$意义下的逆元是有解的！

​	$sqrt(5)=383008016$

​	$sqrt(5)/5=276601605$
​	$(1+sqrt(5))/2=691504013$
​	$(1-sqrt(5))/2=308495997$
​	利用公式
​	注意本题$q-1$的逆元为$q$
​	所以，	$q\times (q^n-1)/(q-1)=q^2(q^n-1)=q^(n+2)-q^2$

​	注意用线段树维护等比数列



##### http://codeforces.com/problemset/problem/711/E

> ​	给定N,K，已知一年有2^N天，选取K个人，两个人的生日是在同一天的的概率要求，$1<=n,k<=1e18$，答案作为分数，对$1e6+3$取模——在取模之前约分！

​	考虑当$2^N<K$的时候，显然是1,1。否则答案就是$(1- A_{2^n}^{k}) \div (2^{nk})$，考虑如何化简这个式子。

​	首先，$A(2^n,k) = (2^n)∗(2^n−1)∗(2^n−2)∗ ... ∗(2^n−k+1)$那么在把一个2^n约掉之后，考虑到他们的$gcd$一定也是2的幂次，显然分母所包含的2比分子包含的多所以只要看分子还有多少2即可。注意到，如果$k$是$2^m$的倍数，那么$2^n-k$也是$2^m$的倍数。所以只要看$(k-1)!$有多少个因子2即可。这个很好解决。

​	那么分子其实不会超过1e6+3次运算，因为可能出现0。

##### http://codeforces.com/problemset/problem/121/C

>​	对于一个数，如果它仅包含4或7，则称之为幸运数。求1~n的第K个置换，有多少幸运数位于的位置也是幸运数。$(n,k<=1e9)$

​	考虑到，$13!$已经超过1e9了，所以事实上前面好多位都是不会变的。那么只要暴力加上去，再暴力算出后面的就行了。

##### http://codeforces.com/problemset/problem/772/C

>​	给定n个0~m-1内的数和m，构造一个尽可能长的所有元素都在0~m-1内的数列，并且使所有前缀积模m不相同且不在n个数中出现过。

​	考虑到所有的$gcd$都是非递减的。那么考虑小的$gcd$一定能通过乘上某个数变成其倍数的$gcd$，因此，把不同的$gcd$的个数求出来，跑一个$DP$（类似$DAG$最长路），然后可以得到一系列的前缀和。再通过前缀和，解同余方程得到最后的$Ans$。

​	为什么是非递减的？因为如果当前数a和$m​$的$gcd​$是x的话，那么对于1到m-1的任何一个数b，因为满足它们$gcd(a,m)=x​$，也就是要知道$gcd(a*b,m) = y​$,首先，因为a和m都有公因数x，所以$\large y=gcd(\frac{a*b}{x},\frac{m}{x}) * x​$,这时候已经可以发现$y>=x​$了。

​	考虑为什么一定有解？因为最终我们得到了前缀积。我们要做的是通过前缀积算出结果，设前面一个的前缀积是$a$，后面一个是$b$，那么目的是要找出满足$ax \equiv b \pmod {m}$，因为我们知道,$gcd(a,m)<=gcd(b,m)$，所以设$gcd(a,m) = d$，$a=a/d$,$b=b/d$，那么现在还是找出$ax \equiv b(mod m/gcd(a,b))$，那么我们要知道a关于m的逆元即可。而此时a和m已经互质，逆元可以通过$ex_gcd$求出。

##### http://codeforces.com/contest/396/problem/B

> 定义函数v(n)为不大于n的最大素数。定义函数u(n)为大于n的最小素数。求Σ1/(v(i)*u(i))(2<=i<=n)。$T<=500,n<=1e9$

​	裂项：这样假设有$n$，$v = v(n),  u = u(n)； $

​	$1/(2*3) + 1/(3*5) * (5-3) + ...... + 1/(v*u) * (n-v+1)  (注意最后不是u-v个）$

​	$= 1/2 - 1/3 + 1/3 - 1/5 + ........ -1/v + 1/(v*u) *(n-v+1)$

​	$= 1/2 - 1/v + 1/(v*u)*(n-v+1)$

​	$p = u*v + 2*(n-v-u+1); q = 2*u*v;$

